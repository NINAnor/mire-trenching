[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Mire trenching indicator",
    "section": "",
    "text": "1 Background and aims\nIn order to describe the ecological condition of wetland, a careful consideratin of mire hydrology is essential. Still, there are no operational ecosystem condition indicators that adequately describe the hydrological status of wetlands in Norway. In Norway, trenching in order to lower the water table of mires has been widely conducted for centuries, and systematically conducted for about 150 years, most commonly in order to facilitate the cultivation of crops or trees. Today, the creation of new trenches is not allowed, yet the scars of old and also more recently made or maintained trenches are evident in the landscape. Many of the trenched areas have changed from open wetlands into forest or agriculture.\nThere are no official maps of mire trenches in Norway. In order to make such a map, Vegar Bakkestuen and colleagues did a pilot study to see if they could identify trenches from LiDAR (Jansson et al. 2024). After annotating ground-trouthed data from several regions in Norway, they trained a deep-learning algorithm to estimate the probability of the occurrence of trenches. The model was applied to a number of smaller study areas in Norway. The results were promising, and efforts are underway to scale up this model and predict mire trenches across Norway.\nThe trenching map provides a probability for the occurrence of trenches in 1x1 m grid cells. Although the deep learning model is trained on trenches in mires, forests and swamp forests, the map identifies trenches across whole landscapes, including trenches in agricultural areas, road ditches, etc.\nThis projects goal is to develop a concept for how a forthcomming national trenching map can be used to characterize the hydrological status of mires in Norway though the use of a normative indicator. Some of the requirements for such an indicator include having area-representative data (i.e.¬†wall-to-wall data or balanced on key environmental variables), and the ability to regularly update the indicator values based on new information. It is also recommended that indicators are based on open data and source code.\n\n\n\n\nJansson, U., Bakkestuen, V., Lyngstad, A., and Mienna, I.M. 2024. Utvikling av gr√∏ftekart i myr og torvmark i norge med hjelp av dypl√¶ring.",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Background and aims</span>"
    ]
  },
  {
    "objectID": "study-area.html",
    "href": "study-area.html",
    "title": "2¬† Study area and trenching data",
    "section": "",
    "text": "2.1 Adding AR5\nThe open wetlands, shown as red areas in Figure¬†2.2, are largely laying outside of the systematically trenched areas. This can be because the trenched areas, which may have been open mire to begin with, now are overgrown with trees. The map of open mires is in way trained to find areas that are not trenched, so no wonder if the ecosystem condition looks good in these areas. Instead I think we should include forested mires in the Ecosystem Type (ET). We can use the mire class in the AR5 maps in addition to the open mires map. AR5 underestimates the total mire area, but it probably includes more forested mires. Another alternative would be to use the new Ecosystem Map of Norway (Strand et al. 2023), but this uses AR50, i.e.¬†as coarser generalization of AR5.\nRead AR5 and plotar5 &lt;- readRDS(\"data/ar5.rds\")\nggplot() + \n  geom_sf(data = ar5,\n          aes(fill = Arealtype)) +\n  geom_sf(data = lev_crop,\n          fill = \"yellow\",\n          color = \"yellow\")\n\n\n\n\n\n\nFigure¬†2.3: ‚ÄúAR5 overlayed with the mire trenches data. AR5 classifies most of the systamtically trenched peatlands as mire, and some as forest.\nLet‚Äôs separate out the areas that are mire in AR5, but not in the open mire map, and see if adding these areas make a difference. Of coarse, we are only looking at a very small spatial extent here, and it is not representative for all the differences between AR5 and the opne mire map, but still.\nFilter data# make the ecosystem delineation map into polygons\nmire &lt;- st_as_sf(mire10_crop, merge = T)\nmire_gg &lt;- ggplot(data = mire)+\n  geom_sf(fill = \"blue\")+\n  labs(title = \"Open mire model\")\n\n# Filter out the mire part of AR5\nar5_myr &lt;- ar5 |&gt;\n  filter(Arealtype == \"Myr\") |&gt;\n  st_cast(\"POLYGON\")\nar5_myr_gg &lt;- ggplot(data = ar5_myr)+\n  geom_sf(fill = \"cyan4\")+\n  labs(title = \"AR5\")\n\n# Take out the open mire part of AR5 (leaving the forested peatlands)\nst_erase = function(x, y) st_difference(x, st_union(st_combine(y)))\nar5_nonOpen &lt;- ar5_myr |&gt;\n  st_erase(mire)\n\n# Take out the AR5 part of the open mire model\nonly_open &lt;- mire |&gt;\n  st_erase(ar5_myr) |&gt;\n  st_cast(\"MULTIPOLYGON\") |&gt;\n  st_cast(\"POLYGON\")\n\nonly_open_gg &lt;- ggplot(data = only_open)+\n  geom_sf(fill = \"purple\")+\n  labs(title = \"Open mires not in AR5\")\n\nar5_nonOpen_gg &lt;- \n  ggplot(data = ar5_nonOpen)+\n  geom_sf(fill = \"orange\")+\n  labs(title = \"AR5 minus open mires\")\n\n# check that polygons dont overlap\ncheck &lt;- \n  ggplot(data = ar5_nonOpen)+\n  geom_sf(fill = \"red\",\n          alpha=.5)+\n  geom_sf(data = mire,\n          fill = \"blue\",\n          alpha=.5)+\n  labs(title = \"AR5 (red) and open mires\\n (blue) combined\")\n\n# combine into new mire map\n# This first attempt with st_union produces way to many small polygon\n#peatlands &lt;- ar5_myr |&gt;\n#  st_union(mire) |&gt;\n#  st_cast(\"MULTIPOLYGON\") |&gt;\n#  st_cast(\"POLYGON\")\n\n#but this works:\npeatlands &lt;- ar5_myr |&gt;\n  st_join(mire) |&gt;\n  st_intersection()\n\npeatlands_gg &lt;- ggplot(data = peatlands)+\n  geom_sf(fill = \"green\")+\n  labs(title = \"AR5 + open mires\")\nPlot dataggarrange(mire_gg, \n          ar5_myr_gg, \n          ar5_nonOpen_gg, \n          only_open_gg,\n          check, \n          peatlands_gg,\n          ncol=2, nrow=3)\n\n\n\n\n\n\nFigure¬†2.4: ‚ÄúDifferent combinations of the open mire model and the AR5 mire category.‚Äù",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Study area and trenching data</span>"
    ]
  },
  {
    "objectID": "study-area.html#sec-delineation",
    "href": "study-area.html#sec-delineation",
    "title": "2¬† Study area and trenching data",
    "section": "\n2.2 Ecosystem delineation",
    "text": "2.2 Ecosystem delineation\nWe presented a study area that is practically square (Figure¬†2.1). However, for the purpose of an ecosystem condition account or assessment, this area needs to be partitioned into unique and non-overlapping ecosystems, and our indicator needs to address the ecosystem condition the target ecosystem explicitly. The ecosystem that this indicator is aimed at is wetlands, or v√•tmark in Norwegian.\nWe might therefore need to mask our spatial data at some stage in order to exclude trenches identified in other ecosystems. However, this is problematic for several reasons.\nWe do not have a very precise ecosystem delineation map for wetlands, and it is not yet clear if the ecosystem should be defined as all types of wetlands, or just open wetlands. In the case of the latter, we have a quite good ecosystem map that we can use (Figure¬†2.2). But by excluding everything that is not open mire, we automatically exclude wetlands, or previous wetlands, that have become forested due to the lowered water table that comes from trenching. In other words, we exclude the areas that are in the worst condition. From Figure¬†2.2 we can see that this is a very common scenario. Alternatively, we can use things like AR5, or a combination of the two (Figure¬†2.4).\nWhen it comes to updating the indicator in the future (see Chapter 4), we will be in the case that more and more trenched wetland becomes classified as other nature types, mainly forests, because that is what happens when you trench a mire. As a consequence, the indicator values will look better and better over time, reflection the land use change and the associated loss of the areas in worst condition. This is a well known issue in ecosystem accounting (ref Jacobson).\nWe recommend for this indicator to delineate the nature type as open mires in the open mire model (Bakkestuen et al. 2023), in combination with mires in AR5 (Figure¬†2.4; last pane).",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Study area and trenching data</span>"
    ]
  },
  {
    "objectID": "metrics.html",
    "href": "metrics.html",
    "title": "3¬† Possible metrics",
    "section": "",
    "text": "3.1 Frequency-based metrics\nThe frequency of trenches can be measured in many ways and at many different scales. One way is to use the method described for NiN variable 7TK (Rune Halvorsen and Harald Bratli 2019). This approach consists of gridding the entire study region into 10ùñ∑10 m cells, and then categorizing the cells as having or not having trenches. The frequency of grid cells with trenches determines the variable value. There is a worked example of this in Chapter 5.\nThe upper and lower reference values for the variable may be defined using the natural value of 0% and 100%, respectively. However, the rescaling of the variable into an indicator should probably follow some non-linear function, potentially aided by one or more class boundaries, such as a threshold value representing the value of the variable that defines the separation distinction good and bad ecosystem condition (Jakobsson et al. 2020) . Expert opinion, possibly aided by real word data or visual aids such as areal photos of areas with different variable value, could be used to set this threshold value (as we later did; see Chapter 6).\nA different option for a frequency-based metric include counting the proportion of mire units (e.g.¬†hydrological units) that are affected by trenching. This approach require that we know the population of mire units, or that we have a good, balanced sample of such units, to base our metric on. We do not have this currently. Secondly, the metric, as is it described here, becomes quite sensible to errors in the trenching model, and would probably require setting some (arbitrary) threshold value for the severity of trenching on each mire unit.",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Possible metrics</span>"
    ]
  },
  {
    "objectID": "metrics.html#length-based-metrics",
    "href": "metrics.html#length-based-metrics",
    "title": "3¬† Possible metrics",
    "section": "3.2 Length based metrics",
    "text": "3.2 Length based metrics\nAs describes earlier, the length of trenches, and therefore also the accumulated length for any given area, may be approximated by using half the circumference of the trenching polygons (minus some small penalty). This metric is very simple and easily interpretable. The metric is also ecologically relevant, as the length of trenches is probably among the metrices that best explain the impact of trenching on the landscape (in combination with the depth of the trenches, but this is not something we have data on currently).\nThe upper reference value must be defined as 0 m of trenches. The lower reference value is not obvious, nor the threshold value. These could be defined using expert opinion, as described for Section 3.1.\n\n3.2.1 Area-based metric\nThe area affected by trenching can perhaps be estimated by adding a buffer on the trenching polygons. The area affected by trenching as a proportion of the total mire area is a nice and simple concept for an indicator. The challenge is how to define the buffer. 10 m buffers have been used in the past. However, the size of the effect from a trench decreases non-linearly from the center of the ditch, and the length of the effect zone will depend a lot on the local typography.",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Possible metrics</span>"
    ]
  },
  {
    "objectID": "metrics.html#scalability",
    "href": "metrics.html#scalability",
    "title": "3¬† Possible metrics",
    "section": "3.3 Scalability",
    "text": "3.3 Scalability\nThe metric chosen to inform the indicator on trenching should idealy be scalable, meaning it can be calculated or interpreted at different scale. The indicator might be useful for regional assessment of wetland condition, as well as in local or project scale assessment, for example in association with environmental impact assessments for new building projects.\nI believe the three methods describe above are all scalable and could be used at local scales as well as regional scale (which is the main focus here).\n\n\n\n\nJakobsson, S., T√∂pper, J.P., Evju, M., Framstad, E., Lyngstad, A., Pedersen, B., Sickel, H., Sverdrup-Thygeson, A., Vandvik, V., Velle, L.G., Aarrestad, P.A., and Nyb√∏, S. 2020. Setting reference levels and limits for good ecological condition in terrestrial ecosystems  insights from a case study based on the IBECA approach. Ecological Indicators 116. doi:10.1016/j.ecolind.2020.106492.\n\n\nRune Halvorsen, and Harald Bratli. 2019. Dokumentasjon av NiN versjon 2.2 tilrettelagt for praktisk naturkartlegging: Utvalgte variabler fra beskrivelsessystemet.  natur i norge, artikkel 11 (versjon 2.2.0).",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Possible metrics</span>"
    ]
  },
  {
    "objectID": "how-to-update.html#footnotes",
    "href": "how-to-update.html#footnotes",
    "title": "4¬† Options for updating the trenching indicator",
    "section": "",
    "text": "https://services.arcgis.com/2JlC1JM9VNKvqb4F/arcgis/rest/services/Myrrestaurering_Groft_Torvtak_3_visning/FeatureServer‚Ü©Ô∏é",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Options for updating the trenching indicator</span>"
    ]
  },
  {
    "objectID": "7TK.html",
    "href": "7TK.html",
    "title": "5¬† Frequency-based metric",
    "section": "",
    "text": "5.1 Including forest peatlands\nNow let‚Äôs calculate the indicator value based on the orange areas (the third map) and the green areas (the last map) in Figure¬†2.4, and see if it looks very different what we had.\nCalculate indicator values for non-open mires in AR5grid100_freq3 &lt;- trench_in_cell10 |&gt;\n  st_intersection(ar5_nonOpen) |&gt;\n  st_drop_geometry() |&gt;\n  group_by(id10) |&gt;\n  summarise(n = n()) |&gt;\n  ungroup() |&gt;\n  add_column(trenched = 1) |&gt;\n  select(-n) |&gt;\n  right_join(grid10, by = \"id10\") |&gt;\n  mutate(trenched = case_when(\n    is.na(trenched) ~ 0,\n    .default = trenched\n  )) |&gt;\n  st_as_sf() |&gt;\n  st_intersection(ar5_nonOpen) |&gt;\n  st_drop_geometry() |&gt;\n  group_by(id) |&gt;\n  summarise(freq = mean(trenched)*100) |&gt;\n  right_join(grid100, by = \"id\") |&gt;\n  st_as_sf() |&gt;\n  st_intersection(ar5_nonOpen)\n\ngrid100_freq3 &lt;- grid100_freq3 |&gt;\n  mutate(indicator = \n           ea_normalise(\n  data = grid100_freq3,\n  vector = \"freq\",\n  upper_reference_level = 50,\n  lower_reference_level = 0,\n  break_point = 10,\n  scaling_function = \"sigmoid\",\n  reverse=T,\n  plot = F))\n\ngrid100_freq3 |&gt;\n  ggplot() +\n  geom_sf(aes(fill = indicator))+\n  theme_bw() +\n  geom_sf(data = trench_in_cell)+\n  scale_fill_gradient(\n    \"Indicator value\", \n    low = high, \n    high = low)\n\n\n\n\n\n\nFigure¬†5.8: ‚ÄúIndicator values over non-open AR5 mires only‚Äù\nFigure¬†5.8 is a lot more red than Figure¬†5.7!\nCalculate indicator values for non-open miregrid100_freq3 &lt;- grid100_freq3 |&gt;\n  mutate(area = st_area(sf..st_make_grid.lev_crop..cellsize...100.))\n\nind_dist_nonopen &lt;- NULL\nfor(i in 1:1000){\n  ind_dist_nonopen[i] &lt;- \n    mean(sample(grid100_freq3$indicator, \n       nrow(grid100_freq3),\n       replace = TRUE,\n       prob = grid100_freq3$area))\n}\n\n#ind_dist_nonopen |&gt;\n#  as_tibble() |&gt;\n#  ggplot()+\n#  geom_density(aes(x = value),\n#    fill = \"burlywood\") +\n#  labs(x = \"Indicator value\")\nLet‚Äôs do the same, but include all AR5 mires, and the little bit extra areas from the open mire map.\nCalculate indicator values for open and non-open miresgrid100_freq4 &lt;- trench_in_cell10 |&gt;\n  st_intersection(peatlands) |&gt;\n  st_drop_geometry() |&gt;\n  group_by(id10) |&gt;\n  summarise(n = n()) |&gt;\n  ungroup() |&gt;\n  add_column(trenched = 1) |&gt;\n  select(-n) |&gt;\n  right_join(grid10, by = \"id10\") |&gt;\n  mutate(trenched = case_when(\n    is.na(trenched) ~ 0,\n    .default = trenched\n  )) |&gt;\n  st_as_sf() |&gt;\n  st_intersection(peatlands) |&gt;\n  st_drop_geometry() |&gt;\n  group_by(id) |&gt;\n  summarise(freq = mean(trenched)*100) |&gt;\n  right_join(grid100, by = \"id\") |&gt;\n  st_as_sf() |&gt;\n  st_intersection(peatlands)\n\ngrid100_freq4 &lt;- grid100_freq4 |&gt;\n  mutate(indicator = \n           ea_normalise(\n  data = grid100_freq4,\n  vector = \"freq\",\n  upper_reference_level = 50,\n  lower_reference_level = 0,\n  break_point = 10,\n  scaling_function = \"sigmoid\",\n  reverse=T,\n  plot = F))\n\n# Option to have uniform class:\ngrid100_freq4 &lt;- grid100_freq4 |&gt;\n  st_cast(\"MULTIPOLYGON\") |&gt;\n  st_cast(\"POLYGON\")\n\n#saveRDS(grid100_freq4, \"data/grid100_freq4.rds\")\n\ngrid100_freq4 |&gt;\n  ggplot() +\n  geom_sf(aes(fill = indicator))+\n  theme_bw() +\n  geom_sf(data = trench_in_cell)+\n  scale_fill_gradient(\n    \"Indicator value\", \n    low = high, \n    high = low)\n\n\n\n\n\n\nFigure¬†5.9: ‚ÄúIndicator values over all peatlands (AR5 + the open mire model)‚Äù\nCalculate indicator values for all miresgrid100_freq4 &lt;- grid100_freq4 |&gt;\n  mutate(area = st_area(sf..st_make_grid.lev_crop..cellsize...100.))\n\nind_dist_all &lt;- NULL\nfor(i in 1:1000){\n  ind_dist_all[i] &lt;- \n    mean(sample(grid100_freq4$indicator, \n       nrow(grid100_freq4),\n       replace = TRUE,\n       prob = grid100_freq4$area))\n}\n\nind_dist_comb &lt;- tibble(\n  open = ind_dist_open,\n  forested = ind_dist_nonopen,\n  all = ind_dist_all\n) |&gt;\n  pivot_longer(\n    cols = everything(),\n    names_to = \"extent\",\n    values_to = \"indicator_value\")\nMake ridge plotind_dist_comb |&gt;\n  ggplot(\n    aes(\n      x = indicator_value, \n      y = extent,\n      fill = after_stat(x))\n  ) +\n  geom_density_ridges_gradient(\n    bandwidth=.005,\n    quantile_lines = TRUE, \n    quantiles = c(0.025, .5, 0.975)\n  ) +\n  scale_fill_distiller(palette = \"RdYlGn\",\n    direction = 1) +\n  theme_bw(base_size = 15) +\n  guides(fill = \"none\") +\n  geom_vline(xintercept = .6,\n    size=1.2,\n    lty=2) +\n  theme(axis.text.x = element_text(angle=45, hjust=1, vjust=1))+\n  labs(y = \"\", x = \"Indicator values\")+\n  xlim(c(0,1)\n)\n\n\n\n\n\n\nFigure¬†5.10: ‚ÄúIndicator values (distributions from bootstrapping) for the mire trenching indicator cacualted for a small test area and using three different ecosystem delineation maps. Vertical lines are 2.5, 50 and 97.5 percentiles.‚Äù\nFigure¬†5.10 shows us that the ecosystem delineation makes a huge difference on the indicator values. Combining AR5 and the open mire model gives a mean indicator value of 0.54, reflection quite predictably the rather binary situation in Figure¬†5.9 where half the area is dark red and the other half is green.\nI think it makes most sense to combine AR5 and the open mire model for this indicator. All indicators used in the same assessment must use the same overall ecosystem delineation, but it is still possible that one indicator related only to a smaller part of that delineation. If using the AR5+open mire combination is not agreeable, then using AR5, alternatively the new Ecosystem Map of Norway (Strand et al. 2023), would be preferable to using just the open mire model.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Frequency-based metric</span>"
    ]
  },
  {
    "objectID": "7TK.html#including-forest-peatlands",
    "href": "7TK.html#including-forest-peatlands",
    "title": "5¬† Frequency-based metric",
    "section": "",
    "text": "Strand, G.-H., Framstad, E., and Opsahl, L.A. 2023. Hoved√∏kosystemkart for norge. NIBIO Rapport.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Frequency-based metric</span>"
    ]
  },
  {
    "objectID": "calibration.html",
    "href": "calibration.html",
    "title": "6¬† Setting reference levels",
    "section": "",
    "text": "6.1 Structured expert elicitation\nRather than using empirical data, we decided to use a kind of structured expert elicitation. Our expert panel consisted of four ecologist with extensive and relevant field experience. First we agreed on the theoretical definition of the RLs (se above). Then we looked at a set of 100x100m grid cells with varying densities of trenches (@fig-calplots). We then scored these cases individually, but following a common discussion, giving each case a precise indicator value. Our interpretation of the indicator scale was aided by both the five condition classes in the water framework directive (high, good, moderate, low, and poor), as well as the five steps on the 7GR-GI metric. This approach mean that we had the same understanding of the indicator scale and the general idea behind the exercise, but it also meant that our answers were influenced by the opinions of the other experts.\nSet up Google API, download and save satelite images# I used this to save the API key to my syst env\n# ggmap::register_google(key = \"\", write = TRUE)\n\n# example of getting sat image for the entire area\n# get center coordinate\ne &lt;- st_as_sfc(st_bbox(grid100_freq4)) |&gt;\n  st_transform(4326) |&gt;\n  st_centroid() |&gt;\n  st_coordinates() |&gt;\n  as.numeric()\nnames(e) &lt;- c(\"lon\", \"lat\")\n  \nsatImg &lt;- ggmap:: get_googlemap(\n  center = e, \n  zoom = 14,\n  maptype = \"satellite\"\n  )\n#ggmap(satImg)\n#saveRDS(satImg, \"data/satImg.rds\")\nGet some grid cells with varying amount of trenching# Transform to 4326 to match ggmap objects\ncells &lt;- grid100_freq4 |&gt;\n  # requre at least half a grid cell\n  filter(area &gt; set_units(5000, m2)) |&gt;\n  mutate(tens = round(freq, -1)) |&gt;\n  group_by(tens) |&gt;\n  slice_max(freq, \n    n = 2,\n    with_ties = F) |&gt;\n  ungroup() |&gt;\n  st_transform(4326)\n  \ncells_c &lt;- cells |&gt;\n  st_centroid() |&gt;\n  st_coordinates() |&gt;\n  as_tibble() |&gt;\n  rename(\"lon\" = \"X\", \"lat\" = \"Y\") \ncells &lt;- cells |&gt;\n  bind_cols(cells_c)\nFunction for downloading static google mapmyGgmap &lt;- function(x, zoom = 18){\n  ggmap:: get_googlemap(\n  center = c(lon = x$lon, lat = x$lat), \n  zoom = zoom,\n  maptype = \"satellite\"\n  )\n}\n\n\n# Hackish function to fix bbox in the ggmap object\n# https://stackoverflow.com/questions/47749078/how-to-put-a-geom-sf-produced-map-on-top-of-a-ggmap-produced-raster\nggmap_bbox &lt;- function(map) {\n  if (!inherits(map, \"ggmap\")) stop(\"map must be a ggmap object\")\n  # Extract the bounding box (in lat/lon) from the ggmap to a numeric vector, \n  # and set the names to what sf::st_bbox expects:\n  map_bbox &lt;- setNames(unlist(attr(map, \"bb\")), \n                       c(\"ymin\", \"xmin\", \"ymax\", \"xmax\"))\n\n  # Coonvert the bbox to an sf polygon, transform it to 3857, \n  # and convert back to a bbox (convoluted, but it works)\n  bbox_3857 &lt;- st_bbox(st_transform(st_as_sfc(st_bbox(map_bbox, crs = 4326)), 3857))\n\n  # Overwrite the bbox of the ggmap object with the transformed coordinates \n  attr(map, \"bb\")$ll.lat &lt;- bbox_3857[\"ymin\"]\n  attr(map, \"bb\")$ll.lon &lt;- bbox_3857[\"xmin\"]\n  attr(map, \"bb\")$ur.lat &lt;- bbox_3857[\"ymax\"]\n  attr(map, \"bb\")$ur.lon &lt;- bbox_3857[\"xmax\"]\n  map\n}\nLoop though and get sat image for each grid cellsatimg &lt;- list(NULL)\nfor(i in 1:nrow(cells)){\n  satimg[[i]] &lt;- ggmap_bbox(myGgmap(cells[i,]))\n}\nsaveRDS(satimg, \"data/satImg.rds\")\nRead cachesatimg &lt;- readRDS(\"data/satImg.rds\")\nLoop through and make maps# convert grid cell df to 3857\ncells2 &lt;- st_transform(cells, 3857)\nlev_crop2 &lt;- st_transform(lev_crop, 3857)\n\nfor (i in 1:nrow(cells2)) {\n  dat &lt;- cells2[i, ]\n\n  suppressMessages(\n  without &lt;- ggmap(ggmap = satimg[[i]]) +\n    coord_sf(crs = st_crs(3857)) +\n    geom_sf(\n      data = dat,\n      inherit.aes = F,\n      fill = NA,\n      color = \"yellow\",\n      size = 2\n    )\n  )\n  \n  suppressMessages(\n  with &lt;- ggmap(ggmap = satimg[[i]])+\n  coord_sf(crs = st_crs(3857))+\n  geom_sf(data = dat, \n          inherit.aes = F,\n          fill = NA,\n          color = \"yellow\",\n          size=2) +\n  geom_sf(data = lev_crop,\n          inherit.aes = F,\n          fill = \"orange\",\n          color = \"orange\") +\n  ggtitle(paste(\"Trenching frequency = \", round(dat$freq, 1),\"%\"))\n  )\n\n  assign(\n    x = paste0(\"ID\", dat$id),\n    ggarrange(with, without)\n  )\n  \n}\nShow mapsfor(i in 1:nrow(cells)){\n  p &lt;- get(paste0(\"ID\", cells$id[i]))\n  print(p)\n}\n\n\n\n\n\n\nFigure¬†6.1\n\n\n\n\n\n\n\n\n\nFigure¬†6.2\n\n\n\n\n\n\n\n\n\nFigure¬†6.3\n\n\n\n\n\n\n\n\n\nFigure¬†6.4\n\n\n\n\n\n\n\n\n\nFigure¬†6.5\n\n\n\n\n\n\n\n\n\nFigure¬†6.6\n\n\n\n\n\n\n\n\n\nFigure¬†6.7\n\n\n\n\n\n\n\n\n\nFigure¬†6.8\n\n\n\n\n\n\n\n\n\nFigure¬†6.9\n\n\n\n\n\n\n\n\n\nFigure¬†6.10\n\n\n\n\n\n\n\n\n\nFigure¬†6.11\n\n\n\n\n\n\n\n\n\nFigure¬†6.12\n\n\n\n\n\n\n\n\n\nFigure¬†6.13\n\n\n\n\n\n\n\n\n\nFigure¬†6.14\n\n\n\n\n\n\n\n\n\nFigure¬†6.15\n\n\n\n\n\n\n\n\n\nFigure¬†6.16\n\n\n\n\n\n\n\n\n\nFigure¬†6.17\n\n\n\n\n\n\n\n\n\nFigure¬†6.18\n\n\n\n\n\n\n\n\n\nFigure¬†6.19\n\n\n\n\n\n\n\n\n\nFigure¬†6.20",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Setting reference levels</span>"
    ]
  },
  {
    "objectID": "calibration.html#more-pictures-from-the-critical-range",
    "href": "calibration.html#more-pictures-from-the-critical-range",
    "title": "6¬† Setting reference levels",
    "section": "\n6.2 More pictures from the critical range",
    "text": "6.2 More pictures from the critical range\nWe scored indicator values for the pictures above, and found that a lot of change was happening in the range between 6 and 17%. We therefore made these extra figures below to get some more data points for this range of trenching frequencies. Since we now had a good internal harmonized understanding of the task, we decided to score these cases indivudually, not knowing the answers or reasoning from the other experts.\n\nGet some grid cells with varying amount of trenching between 6 and 17%# Transform to 4326 to match ggmap objects\ncells_fine &lt;- grid100_freq4 |&gt;\n  # requre at least half a grid cell\n  filter(area &gt; set_units(5000, m2),\n         between(freq, 6, 17)) |&gt;\n  st_transform(4326)\n  \ncells_c_fine &lt;- cells_fine |&gt;\n  st_centroid() |&gt;\n  st_coordinates() |&gt;\n  as_tibble() |&gt;\n  rename(\"lon\" = \"X\", \"lat\" = \"Y\") \ncells_fine &lt;- cells_fine |&gt;\n  bind_cols(cells_c_fine) |&gt;\n  filter(!id %in% cells$id)\n\n\n\nLoop though and get sat image for each grid cellsatimg2 &lt;- list(NULL)\nfor(i in 1:nrow(cells_fine)){\n  satimg2[[i]] &lt;- ggmap_bbox(myGgmap(cells_fine[i,]))\n}\nsaveRDS(satimg2, \"data/satImg2.rds\")\n\n\n\nRead cachesatimg2 &lt;- readRDS(\"data/satImg2.rds\")\n\n\n\nLoop through and make maps# convert grid cell df to 3857\ncells_fine2 &lt;- st_transform(cells_fine, 3857)\n#lev_crop2 &lt;- st_transform(lev_crop, 3857)\n\nfor (i in 1:nrow(cells_fine)) {\n  dat &lt;- cells_fine2[i, ]\n\n  suppressMessages(\n  without &lt;- ggmap(ggmap = satimg2[[i]]) +\n    coord_sf(crs = st_crs(3857)) +\n    geom_sf(\n      data = dat,\n      inherit.aes = F,\n      fill = NA,\n      color = \"yellow\",\n      size = 2\n    )\n  )\n  \n  suppressMessages(\n  with &lt;- ggmap(ggmap = satimg2[[i]])+\n  coord_sf(crs = st_crs(3857))+\n  geom_sf(data = dat, \n          inherit.aes = F,\n          fill = NA,\n          color = \"yellow\",\n          size=2) +\n  geom_sf(data = lev_crop,\n          inherit.aes = F,\n          fill = \"orange\",\n          color = \"orange\") +\n  ggtitle(paste(\"Trenching frequency = \", round(dat$freq, 1),\"%\"))\n  )\n\n  assign(\n    x = paste0(\"ID\", dat$id),\n    ggarrange(with, without)\n  )\n  \n}\n\n\n\nShow mapsfor(i in 1:nrow(cells_fine)){\n  p &lt;- get(paste0(\"ID\", cells_fine$id[i]))\n  print(p)\n}\n\n\n\n\n\n\nFigure¬†6.21\n\n\n\n\n\n\n\n\n\nFigure¬†6.22\n\n\n\n\n\n\n\n\n\nFigure¬†6.23\n\n\n\n\n\n\n\n\n\nFigure¬†6.24\n\n\n\n\n\n\n\n\n\nFigure¬†6.25\n\n\n\n\n\n\n\n\n\nFigure¬†6.26\n\n\n\n\n\n\n\n\n\nFigure¬†6.27\n\n\n\n\n\n\n\n\n\nFigure¬†6.28\n\n\n\n\n\n\n\n\n\nFigure¬†6.29\n\n\n\n\n\n\n\n\nHalvorsen, R., and Bratli, H. 2019. Dokumentasjon av NiN versjon 2.2 tilrettelagt for praktisk naturkartlegging: Utvalgte variabler fra beskrivelsessystemet.  natur i norge, artikkel 11 (versjon 2.2.0).",
    "crumbs": [
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Setting reference levels</span>"
    ]
  },
  {
    "objectID": "RL-regression.html",
    "href": "RL-regression.html",
    "title": "7¬† Identifying reference levels",
    "section": "",
    "text": "Here we show the results from the two session of expert elicitation explained in Chapter 6.\nThe black circles in Figure¬†7.1 shows a remarkable consistency in the experts answers from the first communal session, and a strong relationship between trenching frequency and (perceived) indicator values. The exception is for one point around 25% trenching frequency where everybody scored an indicator value of 1, due to a common agreement that the trenches in the image did not represent real trenches, but was rather an artifact of the model. There are artefacts in the trenching map, and probably also will be in the final national trenching map. We therefore argue that images with such artefacts should be allowed to influence the choice of reference levels. However, this data point had relatively little influence on the loess smoothers in Figure¬†7.1 but there were more possible artifact assessed during the second elicitation session.\nBased on the first session and the expert scoring of 16 images of varying trenching frequency, we found that X60 should be anchored to just around 10% trenching frequency (black line in Figure¬†7.1), and the x100 can be anchored at around 85-90%. However, there is still a few non-zero values at the far right of the figure, indicator that perhaps X100 should conservatively be set higher, for example to 100%.\nIn the first session we experienced that there was a steep decline in indicator values in the beginning, with trenching frequencies &lt;20%. We therefore scored yet another 9 cases from this critical range, but this time the experts did not get to discuss the images with the others. This led to much higher variation in responses, and generally higher indicator values (colored circles and orange regression line in Figure¬†7.1).\n\nImport datadat &lt;- readRDS(\"data/expertElicitation.RDS\")\n\n\n\nMake figureappend &lt;- dat |&gt;\n  mutate(percentTrenching = 0,\n         indicatorValue = 1,\n         Figure = 0)\n\ndat |&gt;\n  #filter(Figure &lt; 21) |&gt;\n  # add zeros\n  bind_rows(append) |&gt;\n  ggplot(aes(x = percentTrenching, \n                 y = indicatorValue)) +\n  geom_point(data = ~ filter(.x, Figure &lt;21),\n             size = 4,\n             alpha=.5,\n             fill = \"grey20\",\n             position = position_dodge2(width=3)) +\n  theme_bw( base_size = 12) +\n  scale_y_continuous(breaks = seq(0,1, by=.2)) +\n  scale_x_continuous(breaks = seq(0,100, by=10)) +\n  theme(panel.grid.major.y = element_line(color = \"red\",\n                                          linewidth = 1)) +\n  geom_point(data = ~ filter(.x, Figure &gt;20),\n             aes(color = Person),\n             size = 4,\n             alpha=.7,\n             #color = \"orange3\",\n             position = position_dodge2(width=3)) +\n  geom_smooth(data = ~ filter(.x, Figure &lt;21),\n              color = \"grey20\",\n              se=F)+\n  geom_smooth(data = ~ filter(.x, Figure &gt;20, indicatorValue!=1),\n              method = \"lm\",\n              se= F,\n              colour = \"orange\",\n              linewidth = 2)+\n  geom_smooth(color = \"blue\") +\n  guides(color = \"none\")\n\n\n\n\n\n\nFigure¬†7.1: ‚ÄúIndicator values assigned by four experts to each of 25 images showing aerial photos of 100x100m grid cells (with about 100 m buffer area around the grid cells) overlaid with polygons showing the presence of trenches. 16 images were discussed together and the indicator values were assigned individually (black circles and line), in random order, but where the subsequent expert had knowledge of the answers from the foregoing experts. 9 addition images were score immediately afterwards, but where the experts did not get a chance to discuss with eacher, and scored the images separately (colored circles (referring to different experts) and orange line). Horizontal red lines are visual aids to identify the trenching frequency associated with each of the five indicator values. The regression lines (grey for first 16 images, orange for subsequent 9 images, and blue for all data points combined) are loess smoothers (linear for the orange circles), and are added for for visual aid. For the loess smoothers, we added 100 false data points to force the intercept through 1. Note a small amount of horizontal jitter added to the data points to illuminate overlapping points.‚Äù\n\n\n\n\nOne reason for the generally much higher values in the second session, using individual expert elicitation, could be that there were by chance more images showing trenches that the experts interpreted as artifacts of the model, and not as real trenches. This implies that is a future trenching map is able to reduce these artifact, then the RLs should be recalculated.\nCombining data from the two expert elicitation sessions we end up with the blue line in Figure¬†7.1, and the following reference levels:\n\nX0 = 100%\nX20 = 52%\nX40 = 31%\nX60 = 16%\nX80 = 7%\nX100 = 0%",
    "crumbs": [
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Identifying reference levels</span>"
    ]
  },
  {
    "objectID": "Results.html",
    "href": "Results.html",
    "title": "\n8¬† Results\n",
    "section": "",
    "text": "Based on what is describes in the preceding chapters, we have arrived at a concept for an indicator on the severity of trenching in Norwegian wetlands. We base the indicator on the theoretical content of the NiN variable 7GR-GI for trenching and the approach used in the 7TK variable, using the proportion of 10x10m grid cells inside 100x100m grid cells that have non-zero trenching as the metric. The reference levels (RL) are decided through expert elicitation, and we have 6 RLs, including 4 class boundaries and two end points. We use a piece-wise linear scaling to convert the variable into an indicator.\nThe indicator will be updated using spatial data showing the amount of trenched restored (Chapter 4), as well as updates to the ecosystem delineation maps. As the ecosystem delineation we recoment using AR5 in combination with the open wetland map (see Chapter 2).\n\nNormalisation functionmyNorm &lt;- function(x, x0, x20, x40, x60, x80, x100) {\n  y &lt;- case_when(\n    x &gt;x100 ~ 1,\n    x &gt;x80 ~ (x-x80)/(x100-x80)*(1 - 0.8)   + 0.8,\n    x &gt;x60 ~ (x-x60)/(x80-x60) *(0.8 - 0.6) + 0.6,\n    x &gt;x40 ~ (x-x40)/(x60-x40) *(0.6 - 0.4) +0.4,\n    x &gt;x20 ~ (x-x20)/(x40-x20) *(0.4 - 0.2) +0.2,\n    x &gt;x0  ~ (x-x0) /(x20-x0) *0.2,\n    x &lt;=x0  ~ 0\n  )\n  y &lt;- y * (-1) + 1  \n  return(y)\n}\n\n# Testing\n#var &lt;- seq(0, 1000, by = 5)\n#ind &lt;- myNorm(var, 100, 200, 250, 600, 700, 800)\n#tibble(var, ind) |&gt;\n#  ggplot()+\n#  geom_point(aes(var, ind))+\n#  scale_y_continuous(breaks = seq(0,1, by = .1))\n\n\n\nMake plotdat &lt;- readRDS(\"data/grid100_freq4.rds\")\n\ndat &lt;- dat |&gt;\n  mutate(indicator2 = myNorm(dat$freq, 0, 7, 16, 31, 52, 100))\n\n\nridge &lt;- ggridges::geom_density_ridges_gradient(scale = 3, \n      size = 0.3)\n\nWarning in ggridges::geom_density_ridges_gradient(scale = 3, size = 0.3):\nIgnoring unknown parameters: `size`\n\nMake plotmyColour &lt;- \"black\"\nmySize &lt;- 8\nmyAlpha &lt;- 0.7\nmyShape &lt;- 21\nlow &lt;- \"red\"\nhigh &lt;- \"green\"\n\ndat|&gt;\n   ggplot(aes(x = freq, y = indicator2, \n      fill = indicator2)) + geom_point(colour = myColour, \n      size = mySize, alpha = myAlpha, shape = myShape) + \n      ylab(\"Indicator values\") + xlab(\"Variable values\") + \n      scale_fill_gradient(\"Indicator values\", low = low, \n        high = high) + scale_x_continuous(expand = expansion(mult = 0.2)) + \n      scale_y_continuous(expand = expansion(mult = 0.2)) + \n      guides(fill = \"none\")\n\n\n\n\n\n\nFigure¬†8.1: Normalisation of the variable using piece-wise linear transformation.\n\n\n\n\n\nMake maptrench_in_cell &lt;- readRDS(\"data/trench_in_cell.RDS\")\nlow &lt;- \"red\"\nhigh &lt;- \"green\"\ndat |&gt;\n  ggplot() +\n  geom_sf(aes(fill = indicator2))+\n  theme_bw() +\n  geom_sf(data = trench_in_cell)+\n  scale_fill_gradient(\n    \"Indicator value\", \n    low = low, \n    high = high)\n\n\n\n\n\n\nFigure¬†8.2: Indicator values representing the severity of trenching in wetlands\n\n\n\n\n\nCalculate indicator valuedat &lt;- dat |&gt;\n  mutate(area = st_area(sf..st_make_grid.lev_crop..cellsize...100.))\n\nind_values &lt;- NULL\nfor(i in 1:1000){\n  ind_values[i] &lt;- \n    mean(sample(dat$indicator, \n       nrow(dat),\n       replace = TRUE,\n       prob = dat$area))\n}\n\nmed &lt;- round(quantile(ind_values, c(0.025, 0.5, 0.975)),2)\n\n\nThe indicator value for the area in Figure¬†8.2 is 0.54 [95% CI: 0.49 - 0.6].",
    "crumbs": [
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Results</span>"
    ]
  }
]